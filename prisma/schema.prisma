generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model bookmark {
  id        Int  @id @default(autoincrement())
  post_id   Int
  author_id Int
  post      post @relation(fields: [post_id], references: [id], map: "Bookmark_post_id_fkey")

  @@unique([post_id, author_id], map: "Bookmark_post_id_author_id_key")
}

model comment {
  id        Int      @id @default(autoincrement())
  title     String
  author_id Int
  post_id   Int
  createdAt DateTime @default(now())
  post      post     @relation(fields: [post_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Comment_post_id_fkey")
  author    user  @relation(fields: [author_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "Comment_author_id_fkey")

  @@index([post_id], map: "Comment_post_id_fkey_idx")
}

model follow {
  id          Int @id @default(autoincrement())
  followed_id Int
  follower_id Int
  followed    user @relation("Followers", fields: [followed_id], references: [id])
  follower    user @relation("Following", fields: [follower_id], references: [id])

  @@unique([followed_id, follower_id], map: "Follow_followed_id_follower_id_key")
}

model like {
  id        Int  @id @default(autoincrement())
  post_id   Int
  author_id Int
  post      post @relation(fields: [post_id], references: [id], map: "Like_post_id_fkey")

  @@unique([post_id, author_id], map: "Like_post_id_author_id_key")
}

model post {
  id          Int        @id @default(autoincrement())
  author_id   Int
  createdAt   DateTime   @default(now())
  title       String
  ingredients String     @db.MediumText
  imageUrl    String?
  bookmarks    bookmark[]
  comments    comment[]
  likes        like[]
  shares       share[]
  author        user       @relation(fields: [author_id], references: [id], map: "Post_author_id_fkey")

  @@index([author_id], map: "Post_author_id_fkey")
}

model share {
  id        Int      @id @default(autoincrement())
  post_id   Int
  author_id Int
  createdAt DateTime @default(now())
  post      post     @relation(fields: [post_id], references: [id], map: "Share_post_id_fkey")

  @@index([post_id], map: "Share_post_id_fkey")
}

model user {
  id        Int      @id @default(autoincrement())
  createdAt DateTime @default(now())
  username  String
  name      String
  password  String
  bio       String?
  imageUrl  String?
  posts      post[]
  comments  comment[]

  followers follow[] @relation("Followers")
  following follow[] @relation("Following")
}
